<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name = "viewport" content="width=device-width, initial-scale =1.0">
    <title>Detail Page</title>
  <link rel="stylesheet" href="mybag.css">
  <link rel="stylesheet" href="../img/themify-icons-font/themify-icons/themify-icons.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">

</head>
<body>
<header>
  <!---header-content-->
  <div class="header-content">
    <div class="header-links">
      <p>
        <img src="../img/img-dat/covietnam1.webp" alt="">
      </p>
      <a href="#">USD</a>
      <!--            <a href="#">VND</a>-->
      <a href="../dat-code/contact%20(1).html">Need Help?</a>
      <a href="../dat-code/sign%20in.html">Sign In</a>
    </div>
  </div>

  <!---header-->

  <div id="header-nav">
    <div class="header-left">
      <span class="header-category">Fashion's Women</span>

    </div>
    <h1 class="header-title">
      <img src="../img/img-dat/logo.png" alt="123" width="90px" >

    </h1>
    <div class="header-links">

      <a href="../Minh-code/wishlist.html" class="header-link">
        <span class="header-link-icon ti-heart header-link-icon"></span>
        Live Chat
      </a>
      <a href="../dat-code/mybag.html" class="header-link">
        <span class="header-link-icon ti-shopping-cart header-link-icon"></span>
        My Bag(1)
      </a>
    </div>
  </div>
  <div id="navbar">
    <!--        <nav>-->
    <ul class="nav-menu">
      <li><a href="Home.html">Home</a></li>
      <li><a href="../dat-code/brand.html">Brands</a>
        <ul class="subnav">
          <ul class="subnav-item">
            <img src="../img/img-dat/Nguoi_mau_Gucci_2.jpg " alt="" width="200px" height="auto">
            <ul class="list-nav">
              <li><a href="../dat-code/brand.html">DOLCE & GABBANA</a></li>
              <li><a href="../dat-code/brand.html">Saint Laurent</a></li>
              <li><a href="../dat-code/brand.html">Valentino</a></li>
            </ul>
          </ul>
        </ul>
      </li>
      <li><a href="../dat-code/dress.html">Dresses</a></li>
      <li><a href="../dat-code/shoes.html">Shoes</a></li>
      <li><a href="../dat-code/bags.html">Bags</a></li>
      <li><a href="../dat-code/accessories.html">Accessories</a></li>
      <li><a href="../dat-code/contact%20(1).html">Contact</a></li>
    </ul>
    <!--        </nav>-->
  </div>

<!--body-detail-->
  <div id="body">
    <div class="header">
      <div class="text-left">
        <h3>SHOPPING BAG</h3>
      </div>

      <div class="text-right">

        <p>Need assistance? (866) 434-3169 </p>
        <a href="#"><i class="ti-comment"> Live Chat</i></a>
      </div>
    </div>


<!--Item-container    -->
    <div class="item-container">
      <div class="item-container-inside">
    <div class="header-item">
     <h4 class="item">ITEM</h4>
     <h4> QTY</h4>
     <h4>ACTIONS</h4>
     <h4>SUBTOTAL</h4>
   </div>


    </div>
     </div>
  </div>

  <div id="productDiplayOutside">
    <div id="productDisplay">
    </div>
  </div>


  <div id="checkout">
    <div class="checkout-left">
        <div class="sub-checkout">
          <a href="Home.html">Continue Shopping</a>

        </div>

        <div class="free-ship-option">
          <p>FREE INTERNATIONAL SHIPPING FOR ORDERS ABOVE<br>
          $100USD
          </p>
          <div class="card">
            <div class="img-freeship-brand"><img src="../img/img-dat/visa.png" alt=""></div>
            <div class="img-freeship-brand" ><img src="../img/img-dat/card.png" alt=""></div>
            <div class="img-freeship-brand"><img src="../img/img-dat/american-express.png" alt=""></div>
            <div class="img-freeship-brand"><img src="../img/img-dat/discover.png" alt=""></div>
            <div class="img-freeship-brand"><img src="../img/img-dat/jcb.png" alt=""></div>
            <div class="img-freeship-brand"><img src="../img/img-dat/google-pay.png" alt=""></div>
            <div class="img-freeship-brand"><img src="../img/img-dat/paypal.png" alt=""></div>
          </div>
        </div>
    </div>
    <div class="checkout-right">
        <div class="subtotal">
          <p>Subtotal(1)</p>
          <p class="subTotal"></p>
          <p>FREE Shipping Options</p>
          <p class="freeship">0.00</p>
        </div>

        <div class="estimated-total">
          <p>Estimated Total</p>
          <p class="subTotal"></p>
        </div>

        <div class="checkout-btn">
          PROCEED TO CHECKOUT
        </div>

        <div class="paypal-btn">
          <div class="paypal-icon">
          <img src="../img/img-dat/paypal-btn.png">
          </div>
          <p>Checkout</p>
        </div>
    </div>
  </div>

  <!--help us-->
  <div class="help-us">
    <p>Help us improve</p>
  </div>
  <div class="footer">
    <div class="col-1">
      <h3>Useful Links</h3>
      <a href="#">About</a>
      <a href="#">Service</a>
      <a href="#">Contact </a>
      <a href="#">Shop</a>
      <a href="#">Blog</a>
    </div>

    <div class="col-2">
      <h3>Newsletter</h3>
      <form>
        <input type="email" id="email" name="email" placeholder="Your email address" required>
      </form>
      <br>
      <button type="submit">Subcribe now</button>
    </div>

    <div class="col-3">
      <h3>Contact</h3>
      123,XYZ Road,BSK 345
      <div class="icon">
        <i class="ti-facebook"></i>
        <i class="ti-twitter-alt"></i>
        <i class="ti-youtube"></i>
        <i class="ti-instagram"></i>
      </div>
    </div>
    <div class="col-1">
      <h3>OUR APPS</h3>
      <a href="#">Ipad</a>
      <a href="#">Iphone</a>
    </div>
  </div>
</header>


</body>
<script>
  // localStorage.removeItem('selectedProducts');

  // transform data
  const selectedProducts = JSON.parse(localStorage.getItem('selectedProducts'));
  console.log(selectedProducts);
  const productList = document.getElementById('productDisplay');

  const totalContainers = document.querySelectorAll('.subTotal'); // Lấy phần tử có class là "total"
  const totalPriceElements = [];
  totalContainers.forEach((container) => {
    const totalPriceElement = document.createElement('p');
    totalPriceElement.textContent = '$0'; // Giá trị ban đầu là 0
    container.appendChild(totalPriceElement);
    totalPriceElements.push(totalPriceElement);
  });

  for ( let i = 0; i < selectedProducts.length; i++) {
    const product = selectedProducts[i];
    const productContainer = document.createElement('div');
    productContainer.className = 'product';
    if (product.image) {
      const imageElement = document.createElement('img');
      imageElement.src = product.image;
      productContainer.appendChild(imageElement);
    }

    const brandElement = document.createElement('h5');
    brandElement.textContent = product.brand;
    productContainer.appendChild(brandElement);

    const nameElement = document.createElement('p');
    nameElement.textContent = product.name;
    nameElement.className='name'
    productContainer.appendChild(nameElement);


    // Tạo phần tử cho số lượng và nút tăng giảm
    const increaseButton = document.createElement('button');
    increaseButton.textContent = '+';
    increaseButton.className='increase-btn';
    increaseButton.addEventListener('click', function() {
      quantityElement.value = parseInt(quantityElement.value) + 1;
      product.totalPrice = product.price * parseInt(quantityElement.value);
      totalElement.textContent = 'Total Price: $' + product.totalPrice;
      updateTotalPrice();
    });

    const quantityElement = document.createElement('input');
    quantityElement.type = 'number';
    quantityElement.value = 1; // Số lượng ban đầu là 1
    quantityElement.className='qty-btn';



    const decreaseButton = document.createElement('button');
    decreaseButton.textContent = '-';
    decreaseButton.className='decrease-btn';
    decreaseButton.addEventListener('click', function() {
      const currentValue = parseInt(quantityElement.value);
      if (currentValue > 1) {
        quantityElement.value = currentValue - 1;
        product.totalPrice = product.price * parseInt(quantityElement.value);
        totalElement.textContent = 'Total Price: $' + product.totalPrice;
        updateTotalPrice(); // Thêm dòng này để cập nhật tổng tiền cho tất cả các sản phẩm
      }
    });

    // tạo phần tử cho tổng tiền
    const totalElement = document.createElement('p');
    totalElement.className = 'productTotalPrice';
    totalElement.textContent = ' $' + product.price; // Tổng tiền ban đầu là giá của sản phẩm
    product.totalPrice = product.price;

    // Tạo nút Remove
    const removeButton = document.createElement('button');
    removeButton.textContent = 'Remove';
    removeButton.className='removeBtn'
    removeButton.addEventListener('click', function() {
      // Xóa sản phẩm khỏi selectedProducts
      selectedProducts.splice(i, 1);
      // Cập nhật localStorage
      localStorage.setItem('selectedProducts', JSON.stringify(selectedProducts));
      // Xóa sản phẩm khỏi giao diện
      productList.removeChild(productContainer);
      updateTotalPrice();
    });


    // Thêm phần tử số lượng và nút tăng giảm vào productContainer
    productContainer.appendChild(decreaseButton);
    productContainer.appendChild(quantityElement);
    productContainer.appendChild(increaseButton);
    // Thêm nút Remove vào productContainer
    productContainer.appendChild(removeButton);
// Thêm phần tử tổng tiền vào productContainer
    productContainer.appendChild(totalElement);
    productList.appendChild(productContainer);


    // Hàm cập nhật tổng tiền
    function updateTotalPrice() {
      const productTotalPriceElements = document.getElementsByClassName('productTotalPrice');
      let totalPrice = 0;
      for (let i = 0; i < selectedProducts.length; i++) {
        const product = selectedProducts[i];
        const productContainer = productTotalPriceElements[i].parentNode;
        const quantity = parseInt(productContainer.querySelector('input[type="number"]').value);
        product.totalPrice = product.price * quantity; // Cập nhật giá trị tổng tiền của sản phẩm
        productTotalPriceElements[i].textContent = ' $' + product.totalPrice.toFixed(2);

        totalPrice += product.totalPrice; // Cộng tổng tiền của từng sản phẩm vào tổng số tiền
      }
      totalPriceElements.forEach((element) => {
        element.textContent = '$' + totalPrice.toFixed(2); // Cập nhật giá trị tổng số tiền trong tất cả các phần tử tổng tiền
      });
    }
  }
</script>
</html>